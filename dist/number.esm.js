function y(h){h.directive("number",(t,{value:n,modifiers:s,expression:f},{cleanup:i})=>{let l=(f??"").split("|"),r=l?.[0]??"",o=l?.[3]??n??"",d=l?.[1]??",",c=l?.[2]??".",g=parseInt(s.find(e=>!isNaN(parseInt(e)))??-1),p=s.find(e=>e==="unsigned")!==void 0,R={prefix:r,suffix:o,separator:d,decimalChar:c,precision:g,unsigned:p};m({target:t});let b=()=>{let e=t.value,u=t.selectionStart;u<r.length&&t.setSelectionRange(r.length,r.length),u>e.length-o.length&&t.setSelectionRange(e.length-o.length,e.length-o.length)};t.addEventListener("click",b);let k=e=>{if(e.key!=="-")return;let u=t.value,a=t.selectionStart,L=t.selectionEnd;if(u=u.substring(0,a)+u.substring(L),u!==""){if(t.value.startsWith(r+"-")){t.value=t.value.replace("-",""),t.setSelectionRange(a-1,a-1),t.dispatchEvent(new Event("input",{bubbles:!0})),e.preventDefault();return}t.value=t.value.replace(r,r+"-"),t.setSelectionRange(a+1,a+1),t.dispatchEvent(new Event("input",{bubbles:!0})),e.preventDefault()}};p||t.addEventListener("keydown",k);let E=e=>{if(e.key!=="ArrowLeft"&&e.key!=="ArrowRight"&&e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;let u=t.value,a=t.selectionStart;e.key==="ArrowLeft"&&a--,e.key==="ArrowRight"&&a++,e.key==="ArrowUp"&&(a=0),e.key==="ArrowDown"&&(a=u.length),a<r.length&&(t.setSelectionRange(r.length,r.length),e.preventDefault()),a>u.length-o.length&&(t.setSelectionRange(u.length-o.length,u.length-o.length),e.preventDefault())};t.addEventListener("keydown",E),t.addEventListener("input",m);function m(e){let{value:u,cursorPosition:a}=w(e.target.value,e.target.selectionStart,e?.data===c,R);e.target.value=u,e.target.setSelectionRange(a,a),t.dispatchEvent(new Event("input",{bubbles:!0}))}i(()=>{t.removeEventListener("input",m),t.removeEventListener("click",b),t.removeEventListener("keydown",E),p||t.removeEventListener("keydown",k)})}),h.magic("toNumber",()=>(t,n=".",s=-1)=>Number(v(String(t),0,!1,{decimalChar:n,precision:s,unsigned:!1}).value.replace(n,"."))),h.magic("toFormatted",()=>(t,n="",s=",",f=".",i="",l=-1,r=!1)=>w(t,0,!1,{prefix:n,suffix:i,separator:s,decimalChar:f,precision:l,unsigned:r}).value);function v(t,n,s,{decimalChar:f,precision:i,unsigned:l}){let r=S(t,!l),o=s?n-1:t.indexOf(f);if((i>0||i===-1)&&o!==-1&&(r=r.filter(c=>o!==c)),i>0&&o!==-1){let c=0;for(let g=o+1;g<t.length;g++)r.includes(g)||(c++,c>i&&r.push(g))}t=N(t,r);let d=r.reduce((c,g)=>c+(g<n?1:0),0);return n=n-d,{value:t,cursorPosition:n}}function w(t,n,s,f){({value:t,cursorPosition:n}=v(t,n,s,f));let{prefix:i,suffix:l,separator:r,decimalChar:o}=f,d=t.startsWith("-");n=n-(d?1:0),t=t.replace("-","");let c=t.split(o),g=Math.max(0,Math.floor((Math.min(n,c[0].length)-1)/3));return c[0]=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,r),t=i+(d?"-":"")+c.join(o)+l,n=n+i.length+(d?1:0)+g,t===i+l&&(t="",n=0),{value:t,cursorPosition:n}}function S(t,n){let s=[],f=!1;for(let i=0;i<t.length;i++)if(isNaN(parseInt(t[i]))){if(!f&&t[i]==="-"&&n){f=!0;continue}s.push(i)}else f=!0;return s}function N(t,n){let s=new Set(n);return t.split("").filter((i,l)=>!s.has(l)).join("")}}var D=y;export{D as default};
