function b(h){h.directive("number",(t,{value:n,modifiers:s,expression:u},{cleanup:i})=>{let l=(u??"").split("|"),r=l?.[0]??"",o=l?.[3]??n??"",d=l?.[1]??",",c=l?.[2]??".",g=parseInt(s.find(e=>!isNaN(parseInt(e)))??-1),p=s.find(e=>e==="unsigned")!==void 0,R={prefix:r,suffix:o,separator:d,decimalChar:c,precision:g,unsigned:p};m({target:t});let k=()=>{let e=t.value,f=t.selectionStart;f<r.length&&t.setSelectionRange(r.length,r.length),f>e.length-o.length&&t.setSelectionRange(e.length-o.length,e.length-o.length)};t.addEventListener("click",k);let y=e=>{if(e.key!=="-")return;let f=t.value,a=t.selectionStart,L=t.selectionEnd;if(f=f.substring(0,a)+f.substring(L),f!==""){if(t.value.startsWith(r+"-")){t.value=t.value.replace("-",""),t.setSelectionRange(a-1,a-1),t.dispatchEvent(new Event("input",{bubbles:!0})),e.preventDefault();return}t.value=t.value.replace(r,r+"-"),t.setSelectionRange(a+1,a+1),t.dispatchEvent(new Event("input",{bubbles:!0})),e.preventDefault()}};p||t.addEventListener("keydown",y);let S=e=>{if(e.key!=="ArrowLeft"&&e.key!=="ArrowRight"&&e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;let f=t.value,a=t.selectionStart;e.key==="ArrowLeft"&&a--,e.key==="ArrowRight"&&a++,e.key==="ArrowUp"&&(a=0),e.key==="ArrowDown"&&(a=f.length),a<r.length&&(t.setSelectionRange(r.length,r.length),e.preventDefault()),a>f.length-o.length&&(t.setSelectionRange(f.length-o.length,f.length-o.length),e.preventDefault())};t.addEventListener("keydown",S),t.addEventListener("input",m);function m(e){let{value:f,cursorPosition:a}=w(e.target.value,e.target.selectionStart,e?.data===c,R);e.target.value=f,e.target.setSelectionRange(a,a)}i(()=>{t.removeEventListener("input",m),t.removeEventListener("click",k),t.removeEventListener("keydown",S),p||t.removeEventListener("keydown",y)})}),h.magic("toNumber",()=>(t,n=".",s=-1)=>Number(v(String(t),0,!1,{decimalChar:n,precision:s,unsigned:!1}).value.replace(n,"."))),h.magic("toFormatted",()=>(t,n="",s=",",u=".",i="",l=-1,r=!1)=>w(t,0,!1,{prefix:n,suffix:i,separator:s,decimalChar:u,precision:l,unsigned:r}).value);function v(t,n,s,{decimalChar:u,precision:i,unsigned:l}){let r=E(t,!l),o=s?n-1:t.indexOf(u);if((i>0||i===-1)&&o!==-1&&(r=r.filter(c=>o!==c)),i>0&&o!==-1){let c=0;for(let g=o+1;g<t.length;g++)r.includes(g)||(c++,c>i&&r.push(g))}t=N(t,r);let d=r.reduce((c,g)=>c+(g<n?1:0),0);return n=n-d,{value:t,cursorPosition:n}}function w(t,n,s,u){({value:t,cursorPosition:n}=v(t,n,s,u));let{prefix:i,suffix:l,separator:r,decimalChar:o}=u,d=t.startsWith("-");n=n-(d?1:0),t=t.replace("-","");let c=t.split(o),g=Math.max(0,Math.floor((Math.min(n,c[0].length)-1)/3));return c[0]=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,r),t=i+(d?"-":"")+c.join(o)+l,n=n+i.length+(d?1:0)+g,t===i+l&&(t="",n=0),{value:t,cursorPosition:n}}function E(t,n){let s=[],u=!1;for(let i=0;i<t.length;i++)if(isNaN(parseInt(t[i]))){if(!u&&t[i]==="-"&&n){u=!0;continue}s.push(i)}else u=!0;return s}function N(t,n){let s=new Set(n);return t.split("").filter((i,l)=>!s.has(l)).join("")}}var D=b;export{D as default};
