(()=>{function S(m){m.directive("number",(t,{value:n,modifiers:f,expression:l},{cleanup:i})=>{let u=(l??"").split("|"),r=u?.[0]??"",s=u?.[3]??n??"",d=u?.[1]??",",a=u?.[2]??".",g=parseInt(f.find(e=>!isNaN(parseInt(e)))??2),h=f.find(e=>e==="unsigned")!==void 0,R={prefix:r,suffix:s,separator:d,decimalChar:a,precision:g,unsigned:h};p({target:t});let w=()=>{let e=t.value,c=t.selectionStart;c<r.length&&t.setSelectionRange(r.length,r.length),c>e.length-s.length&&t.setSelectionRange(e.length-s.length,e.length-s.length)};t.addEventListener("click",w);let k=e=>{if(e.key!=="-")return;let c=t.value,o=t.selectionStart,A=t.selectionEnd;if(c=c.substring(0,o)+c.substring(A),c!==""){if(t.value.startsWith(r+"-")){t.value=t.value.replace("-",""),t.setSelectionRange(o-1,o-1),e.preventDefault();return}t.value=t.value.replace(r,r+"-"),t.setSelectionRange(o+1,o+1),e.preventDefault()}};h||t.addEventListener("keydown",k);let y=e=>{if(e.key!=="ArrowLeft"&&e.key!=="ArrowRight"&&e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;let c=t.value,o=t.selectionStart;e.key==="ArrowLeft"&&o--,e.key==="ArrowRight"&&o++,e.key==="ArrowUp"&&(o=0),e.key==="ArrowDown"&&(o=c.length),o<r.length&&(t.setSelectionRange(r.length,r.length),e.preventDefault()),o>c.length-s.length&&(t.setSelectionRange(c.length-s.length,c.length-s.length),e.preventDefault())};t.addEventListener("keydown",y),t.addEventListener("input",p);function p(e){let{value:c,cursorPosition:o}=E(e.target.value,e.target.selectionStart,e?.data===a,R);e.target.value=c,e.target.setSelectionRange(o,o)}i(()=>{t.removeEventListener("input",p),t.removeEventListener("click",w),t.removeEventListener("keydown",y),h||t.removeEventListener("keydown",k)})}),m.magic("toNumber",()=>(t,n=".",f=2)=>Number(v(t,0,!1,{decimalChar:n,precision:f,unsigned:!1}).value.replace(n,".")));function v(t,n,f,{decimalChar:l,precision:i,unsigned:u}){let r=L(t,!u),s=f?n-1:t.indexOf(l);if(i>0&&s!==-1&&(r=r.filter(a=>s!==a)),i>0&&s!==-1){let a=0;for(let g=s+1;g<t.length;g++)r.includes(g)||(a++,a>i&&r.push(g))}t=N(t,r);let d=r.reduce((a,g)=>a+(g<n?1:0),0);return n=n-d,{value:t,cursorPosition:n}}function E(t,n,f,l){({value:t,cursorPosition:n}=v(t,n,f,l));let{prefix:i,suffix:u,separator:r,decimalChar:s}=l,d=t.startsWith("-");n=n-(d?1:0),t=t.replace("-","");let a=t.split(s),g=Math.max(0,Math.floor((Math.min(n,a[0].length)-1)/3));return a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,r),t=i+(d?"-":"")+a.join(s)+u,n=n+i.length+(d?1:0)+g,t===i+u&&(t="",n=0),{value:t,cursorPosition:n}}function L(t,n){let f=[],l=!1;for(let i=0;i<t.length;i++)if(isNaN(parseInt(t[i]))){if(!l&&t[i]==="-"&&n){l=!0;continue}f.push(i)}else l=!0;return f}function N(t,n){let f=new Set(n);return t.split("").filter((i,u)=>!f.has(u)).join("")}}document.addEventListener("alpine:init",()=>window.Alpine.plugin(S));})();
